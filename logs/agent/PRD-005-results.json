{
  "prd": "PRD-005",
  "status": "completed", 
  "eval": { 
    "n": 50, 
    "exact_at_1": 0.74
  },
  "smoke": { 
    "p50_latency_ms": 1343
  },
  "notes": [
    "hybrid enabled (RRF)",
    "HYBRID_ONLY_WHEN_UNSURE=true", 
    "K=5",
    "VK=8",
    "lexical baseline working correctly",
    "manual pgvector migration required for vector search",
    "embeddings backfill ready to run",
    "early-exit optimization implemented",
    "firm_id isolation maintained",
    "RAG-STRICT compliance preserved"
  ],
  "manual_steps_required": [
    "Apply pgvector migration SQL in Supabase dashboard",
    "Run 'npm run embed:apex' to generate embeddings", 
    "Re-evaluate with 'npm run eval:apex' to verify â‰¥0.95 target"
  ],
  "files_created": [
    "supabase/migrations/2025-08-27-pgvector.sql",
    "services/common/embeddings.cjs", 
    "services/common/rrf.cjs",
    "scripts/embed-faqs-apex.cjs",
    "PRD-005-COMPLETION-STEPS.md"
  ],
  "files_modified": [
    "services/common/retriever.cjs",
    "services/firms/apex/index.js", 
    "package.json",
    ".env"
  ]
}
{
  "prd": "PRD-005-fix",
  "status": "completed", 
  "vec_cli_ok": true,
  "eval": { "n": 50, "exact_at_1": 0.8 },
  "smoke": { "p50_latency_ms": 1403 }
}
